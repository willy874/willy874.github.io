import{cx as e}from"./global-j3Vg8PQg.js";import{getDocument as t,getEventTarget as n,getWindow as r,isMac as i,isVirtualClick as a}from"./dist-ByCWjEmd.js";function o(e){return!(e.metaKey||!i()&&e.altKey||e.ctrlKey||e.key===`Control`||e.key===`Shift`||e.key===`Meta`)}var s=new Set([`checkbox`,`radio`,`range`,`color`,`file`,`image`,`button`,`submit`,`reset`]);function c(e,t,i){let a=i?n(i):null,o=r(a);return e=e||a instanceof o.HTMLInputElement&&!s.has(a?.type)||a instanceof o.HTMLTextAreaElement||a instanceof o.HTMLElement&&a.isContentEditable,!(e&&t===`keyboard`&&i instanceof o.KeyboardEvent&&!Reflect.has(m,i.key))}var l=null,u=new Set,d=new Map,f=!1,p=!1,m={Tab:!0,Escape:!0};function h(e,t){for(let n of u)n(e,t)}function g(e){f=!0,o(e)&&(l=`keyboard`,h(`keyboard`,e))}function _(e){l=`pointer`,(e.type===`mousedown`||e.type===`pointerdown`)&&(f=!0,h(`pointer`,e))}function v(e){a(e)&&(f=!0,l=`virtual`)}function y(e){let i=n(e);i===r(i)||i===t(i)||(!f&&!p&&(l=`virtual`,h(`virtual`,e)),f=!1,p=!1)}function b(){f=!1,p=!0}function x(e){if(typeof window>`u`||d.get(r(e)))return;let n=r(e),i=t(e),a=n.HTMLElement.prototype.focus;function o(){l=`virtual`,h(`virtual`,null),f=!0,a.apply(this,arguments)}Object.defineProperty(n.HTMLElement.prototype,`focus`,{configurable:!0,value:o}),i.addEventListener(`keydown`,g,!0),i.addEventListener(`keyup`,g,!0),i.addEventListener(`click`,v,!0),n.addEventListener(`focus`,y,!0),n.addEventListener(`blur`,b,!1),n.PointerEvent===void 0?(i.addEventListener(`mousedown`,_,!0),i.addEventListener(`mousemove`,_,!0),i.addEventListener(`mouseup`,_,!0)):(i.addEventListener(`pointerdown`,_,!0),i.addEventListener(`pointermove`,_,!0),i.addEventListener(`pointerup`,_,!0)),n.addEventListener(`beforeunload`,()=>{S(e)},{once:!0}),d.set(n,{focus:a})}var S=(e,n)=>{let i=r(e),a=t(e);d.has(i)&&(i.HTMLElement.prototype.focus=d.get(i).focus,a.removeEventListener(`keydown`,g,!0),a.removeEventListener(`keyup`,g,!0),a.removeEventListener(`click`,v,!0),i.removeEventListener(`focus`,y,!0),i.removeEventListener(`blur`,b,!1),i.PointerEvent===void 0?(a.removeEventListener(`mousedown`,_,!0),a.removeEventListener(`mousemove`,_,!0),a.removeEventListener(`mouseup`,_,!0)):(a.removeEventListener(`pointerdown`,_,!0),a.removeEventListener(`pointermove`,_,!0),a.removeEventListener(`pointerup`,_,!0)),d.delete(i))};function C(){return l===`keyboard`}function w(e={}){let{isTextInput:t,autoFocus:n,onChange:r,root:i}=e;x(i),r?.({isFocusVisible:n||C(),modality:l});let a=(e,n)=>{c(!!t,e,n)&&r?.({isFocusVisible:C(),modality:e})};return u.add(a),()=>{u.delete(a)}}function T(t,n,r={}){let i=async()=>await Promise.resolve();i();let a={className:e(t.className,n.className,r.className),style:{...t.style,...n.style,...r.style}};delete a.children;let o=[`className`,`style`,`children`],s=[...Object.keys(t),...Object.keys(n),...Object.keys(r)];for(let e of s){if(e in a||o.includes(e))continue;if(typeof e==`string`&&e.startsWith(`on`)){let i=Reflect.get(t,e),o=Reflect.get(n,e),s=Reflect.get(r,e);Reflect.set(a,e,function(...e){typeof i==`function`&&i.apply(this,e),typeof o==`function`&&o.apply(this,e),typeof s==`function`&&s.apply(this,e)})}else Reflect.set(a,e,Reflect.get(t,e)??Reflect.get(n,e)??Reflect.get(r,e))}return a}function E(e){let t={};return Object.entries(e).forEach(([e,n])=>{n&&Object.entries(n).forEach(([n,r])=>{r&&Reflect.set(t,`${e}:${n}`,r)})}),t}export{E as defineArgs,C as isFocusVisible,T as mergeAttrs,w as trackFocusVisible};