import{__toESM as e,require_react as t}from"./iframe-DtrdFlbQ.js";import{require_jsx_runtime as n}from"./jsx-runtime-B3cA1AA9.js";import{addDomEvent as r,callAll as i,contains as a,getDocument as o,getEventTarget as s,getNearestOverflowAncestor as c,getWindow as l,isContextMenuEvent as u,isFocusable as d,isFunction as f,isHTMLElement as p,isShadowRoot as m,isTouchDevice as h,raf as g,setStyle as _,waitForElements as v,warn as y}from"./dist-D4mcTejo.js";function b(e){let t={each(t){var n;for(let r=0;r<(n=e.frames)?.length;r+=1){let n=e.frames[r];n&&t(n)}},addEventListener(e,n,r){return t.each(t=>{try{t.document.addEventListener(e,n,r)}catch{}}),()=>{try{t.removeEventListener(e,n,r)}catch{}}},removeEventListener(e,n,r){t.each(t=>{try{t.document.removeEventListener(e,n,r)}catch{}})}};return t}function x(e){let t=e.frameElement==null?null:e.parent;return{addEventListener:(e,n,r)=>{try{t?.addEventListener(e,n,r)}catch{}return()=>{try{t?.removeEventListener(e,n,r)}catch{}}},removeEventListener:(e,n,r)=>{try{t?.removeEventListener(e,n,r)}catch{}}}}var S=`pointerdown.outside`,C=`focus.outside`;function w(e){for(let t of e)if(p(t)&&d(t))return!0;return!1}var T=e=>`clientY`in e;function E(e,t){if(!T(t)||!e)return!1;let n=e.getBoundingClientRect();return n.width===0||n.height===0?!1:n.top<=t.clientY&&t.clientY<=n.top+n.height&&n.left<=t.clientX&&t.clientX<=n.left+n.width}function D(e,t){return e.y<=t.y&&t.y<=e.y+e.height&&e.x<=t.x&&t.x<=e.x+e.width}function O(e,t){if(!t||!T(e))return!1;let n=t.scrollHeight>t.clientHeight,r=n&&e.clientX>t.offsetLeft+t.clientWidth,i=t.scrollWidth>t.clientWidth,a=i&&e.clientY>t.offsetTop+t.clientHeight,o={x:t.offsetLeft,y:t.offsetTop,width:t.clientWidth+(n?16:0),height:t.clientHeight+(i?16:0)},s={x:e.clientX,y:e.clientY};return D(o,s)?r||a:!1}function k(e,t){let{exclude:n,onFocusOutside:f,onPointerDownOutside:_,onInteractOutside:v,defer:y}=t;if(!e)return;let T=o(e),D=l(e),k=b(D),A=x(D);function M(t,r){if(!p(r)||!r.isConnected||a(e,r)||E(e,t))return!1;let i=T.querySelector(`[aria-controls="${e.id}"]`);if(i){let e=c(i);if(O(t,e))return!1}let o=c(e);return O(t,o)?!1:!n?.(r)}let N=new Set,P=m(e?.getRootNode());function F(t){function n(n){var r;let a=y&&!h()?g:e=>e(),o=n??t,c=(o==null||(r=o.composedPath)==null?void 0:r.call(o))??[o?.target];a(()=>{let n=P?c[0]:s(t);if(!(!e||!M(t,n))){if(_||v){let t=i(_,v);e.addEventListener(S,t,{once:!0})}j(e,S,{bubbles:!1,cancelable:!0,detail:{originalEvent:o,contextmenu:u(o),focusable:w(c),target:n}})}})}t.pointerType===`touch`?(N.forEach(e=>e()),N.add(r(T,`click`,n,{once:!0})),N.add(A.addEventListener(`click`,n,{once:!0})),N.add(k.addEventListener(`click`,n,{once:!0}))):n()}let I=new Set,L=setTimeout(()=>{I.add(r(T,`pointerdown`,F,!0)),I.add(A.addEventListener(`pointerdown`,F,!0)),I.add(k.addEventListener(`pointerdown`,F,!0))},0);function R(t){let n=y?g:e=>e();n(()=>{let n=s(t);if(!(!e||!M(t,n))){if(f||v){let t=i(f,v);e.addEventListener(C,t,{once:!0})}j(e,C,{bubbles:!1,cancelable:!0,detail:{originalEvent:t,contextmenu:!1,focusable:d(n),target:n}})}})}return h()||(I.add(r(T,`focusin`,R,!0)),I.add(A.addEventListener(`focusin`,R,!0)),I.add(k.addEventListener(`focusin`,R,!0))),()=>{clearTimeout(L),N.forEach(e=>e()),I.forEach(e=>e())}}function A(e,t){let{defer:n}=t,r=n?g:e=>e(),i=[];return i.push(r(()=>{let n=typeof e==`function`?e():e;i.push(k(n,t))})),()=>{i.forEach(e=>e?.())}}function j(e,t,n){let r=e.ownerDocument.defaultView||window,i=new r.CustomEvent(t,n);return e.dispatchEvent(i)}function M(e,t){let n=e=>{e.key===`Escape`&&(e.isComposing||t?.(e))};return r(o(e),`keydown`,n,{capture:!0})}var N={layers:[],branches:[],count(){return this.layers.length},pointerBlockingLayers(){return this.layers.filter(e=>e.pointerBlocking)},topMostPointerBlockingLayer(){return[...this.pointerBlockingLayers()].slice(-1)[0]},hasPointerBlockingLayer(){return this.pointerBlockingLayers().length>0},isBelowPointerBlockingLayer(e){var t;let n=this.indexOf(e),r=this.topMostPointerBlockingLayer()?this.indexOf((t=this.topMostPointerBlockingLayer())?.node):-1;return n<r},isTopMost(e){let t=this.layers[this.count()-1];return t?.node===e},getNestedLayers(e){return Array.from(this.layers).slice(this.indexOf(e)+1)},isInNestedLayer(e,t){return this.getNestedLayers(e).some(e=>a(e.node,t))},isInBranch(e){return Array.from(this.branches).some(t=>a(t,e))},add(e){let t=this.layers.push(e);e.node.style.setProperty(`--layer-index`,`${t}`)},addBranch(e){this.branches.push(e)},remove(e){let t=this.indexOf(e);if(!(t<0)){if(t<this.count()-1){let t=this.getNestedLayers(e);t.forEach(e=>e.dismiss())}this.layers.splice(t,1),e.style.removeProperty(`--layer-index`)}},removeBranch(e){let t=this.branches.indexOf(e);t>=0&&this.branches.splice(t,1)},indexOf(e){return this.layers.findIndex(t=>t.node===e)},dismiss(e){var t;(t=this.layers[this.indexOf(e)])?.dismiss()},clear(){this.remove(this.layers[0].node)}},P;function F(){N.layers.forEach(({node:e})=>{e.style.pointerEvents=N.isBelowPointerBlockingLayer(e)?`none`:`auto`})}function I(e){e.style.pointerEvents=``}function L(e,t){let n=o(e),r=[];if(N.hasPointerBlockingLayer()&&!n.body.hasAttribute(`data-inert`)&&(P=document.body.style.pointerEvents,queueMicrotask(()=>{n.body.style.pointerEvents=`none`,n.body.setAttribute(`data-inert`,``)})),t){let e=v(t,e=>{r.push(_(e,{pointerEvents:`auto`}))});r.push(e)}return()=>{N.hasPointerBlockingLayer()||(queueMicrotask(()=>{n.body.style.pointerEvents=P,n.body.removeAttribute(`data-inert`),n.body.style.length===0&&n.body.removeAttribute(`style`)}),r.forEach(e=>e()))}}function R(e,t){let{warnOnMissingNode:n=!0}=t;if(n&&!e){y("[@zag-js/dismissable] node is `null` or `undefined`");return}if(!e)return;let{onDismiss:r,pointerBlocking:i,exclude:o,debug:c}=t,l={dismiss:r,node:e,pointerBlocking:i};N.add(l),F();function u(n){var i,a;let o=s(n.detail.originalEvent);N.isBelowPointerBlockingLayer(e)||N.isInBranch(o)||((i=t.onPointerDownOutside)?.call(t,n),(a=t.onInteractOutside)?.call(t,n),!n.defaultPrevented&&(c&&console.log(`onPointerDownOutside:`,n.detail.originalEvent),r?.()))}function d(e){var n,i;let a=s(e.detail.originalEvent);N.isInBranch(a)||((n=t.onFocusOutside)?.call(t,e),(i=t.onInteractOutside)?.call(t,e),!e.defaultPrevented&&(c&&console.log(`onFocusOutside:`,e.detail.originalEvent),r?.()))}function f(n){var i;N.isTopMost(e)&&((i=t.onEscapeKeyDown)?.call(t,n),!n.defaultPrevented&&r&&(n.preventDefault(),r()))}function m(n){var r;if(!e)return!1;let i=typeof o==`function`?o():o,s=Array.isArray(i)?i:[i],c=(r=t.persistentElements)?.map(e=>e()).filter(p);return c&&s.push(...c),s.some(e=>a(e,n))||N.isInNestedLayer(e,n)}let h=[i?L(e,t.persistentElements):void 0,M(e,f),A(e,{exclude:m,onFocusOutside:d,onPointerDownOutside:u,defer:t.defer})];return()=>{N.remove(e),F(),I(e),h.forEach(e=>e?.())}}function z(e,t){let{defer:n}=t,r=n?g:e=>e(),i=[];return i.push(r(()=>{let n=f(e)?e():e;i.push(R(n,t))})),()=>{i.forEach(e=>e?.())}}function B(e,t={}){let{defer:n}=t,r=n?g:e=>e(),i=[];return i.push(r(()=>{let t=f(e)?e():e;if(!t){y("[@zag-js/dismissable] branch node is `null` or `undefined`");return}N.addBranch(t),i.push(()=>{N.removeBranch(t)})})),()=>{i.forEach(e=>e?.())}}var V=e(n()),H=e(t());const U=e=>(0,V.jsx)(`svg`,{width:`1em`,height:`1em`,viewBox:`0 0 24 24`,fill:`none`,xmlns:`http://www.w3.org/2000/svg`,...e,children:(0,V.jsx)(`path`,{d:`M18 6.00005L6 18M5.99995 6L17.9999 18`,stroke:`currentColor`,strokeWidth:1.5,strokeLinecap:`round`,strokeLinejoin:`round`})});var W=U;export{B as trackDismissableBranch,z as trackDismissableElement,W as x_default};